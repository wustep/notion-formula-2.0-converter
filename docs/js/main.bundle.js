!function(){var e,t={89734:function(e,t,r){"use strict";r.r(t)},38957:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(r(67294)),o=r(871),i=r(94055);r(91748),r(89734);const s=r(63587);t.default=function(){var e;const[t,r]=a.default.useState(""),[n,l]=a.default.useState({}),[u,c]=a.default.useState("Copy"),[d,p]=a.default.useState(null);return a.default.useEffect((()=>{const e=(0,o.convertFormula)(t,n);p(e),l(n)}),[t,n]),a.default.createElement(s.Column,null,a.default.createElement(s.Columns,null,a.default.createElement(s.Column,null,a.default.createElement(s.Heading,null,"Formula 1.0"),a.default.createElement(s.TextArea,{value:t,onChange:e=>r(e.target.value)})),a.default.createElement(s.Column,{className:"arrow"},"→"),a.default.createElement(s.Column,null,a.default.createElement(s.Heading,null,"Formula 2.0",!!(null==d?void 0:d.formula.length)&&a.default.createElement(s.Button,{className:"copy-button",onClick:()=>{navigator.clipboard.writeText(null==d?void 0:d.formula),c("Copied!"),setTimeout((()=>{c("Copy")}),1e3)}},u)),a.default.createElement(s.TextArea,{id:"formula2",value:null==d?void 0:d.formula,disabled:!0}))),!!(null===(e=null==d?void 0:d.propsReferenced)||void 0===e?void 0:e.size)&&a.default.createElement("div",null,a.default.createElement("hr",null),a.default.createElement(s.Heading,null,"Property types"),a.default.createElement("p",null,`Property types with changes: ${i.PROPERTY_TYPES_STRING}`),a.default.createElement(s.Table,null,a.default.createElement("tbody",null,Array.from(d.propsReferenced).map((e=>{var t;return a.default.createElement("tr",{key:e},a.default.createElement("td",{className:"property-type-cell"},e),a.default.createElement("td",null,a.default.createElement(s.Select,{value:null!==(t=n[e])&&void 0!==t?t:"other",onChange:t=>{const r=Object.assign(Object.assign({},n),{[e]:t.target.value});l(r)},options:i.PROPERTY_TYPES})))}))))),!!(null==d?void 0:d.changes.length)&&a.default.createElement("div",{className:"content"},a.default.createElement("hr",null),a.default.createElement(s.Heading,null,"Changes"),a.default.createElement("ul",null,d.changes.map(((e,t)=>{var r,n,i;const s=null===(r=null===o.FORMULA_CHANGES_LIST||void 0===o.FORMULA_CHANGES_LIST?void 0:o.FORMULA_CHANGES_LIST[e.changeIdentifier])||void 0===r?void 0:r.description,l=null===(n=null===o.FORMULA_CHANGES_LIST||void 0===o.FORMULA_CHANGES_LIST?void 0:o.FORMULA_CHANGES_LIST[e.changeIdentifier])||void 0===n?void 0:n.example;return a.default.createElement("li",{key:`${e.changeIdentifier}-${t}`},s,a.default.createElement("br",null),"Example: ",a.default.createElement("code",null,null==l?void 0:l(null!==(i=e.context)&&void 0!==i?i:"")),a.default.createElement("br",null))})))))}},63587:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Select=t.TableRow=t.Table=t.Column=t.Columns=t.TextArea=t.Button=t.Heading=void 0;const a=n(r(67294)),o=n(r(94184));t.Heading=function({children:e}){return a.default.createElement("h3",{className:"title is-4"},e)},t.Button=function({onClick:e,children:t,className:r}){return a.default.createElement("button",{className:(0,o.default)("button",r),onClick:e},t)},t.TextArea=function({value:e,onChange:t,disabled:r,id:n}){return a.default.createElement("textarea",{className:"textarea",id:n,value:e,onChange:t,disabled:r})},t.Columns=function({children:e}){return a.default.createElement("div",{className:"columns"},e)},t.Column=function({children:e,className:t}){return a.default.createElement("div",{className:(0,o.default)("column",t)},e)},t.Table=function({children:e}){return a.default.createElement("table",{className:"table"},e)},t.TableRow=function({values:e}){return a.default.createElement("tr",null,e.map(((e,t)=>a.default.createElement("td",{key:t},e))))},t.Select=function({options:e,value:t,onChange:r}){return a.default.createElement("div",{className:"control"},a.default.createElement("div",{className:"select is-fullwidth"},a.default.createElement("select",{value:t,onChange:r},e.map((e=>a.default.createElement("option",{key:e,value:e},e))))))}},92629:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(r(67294)),o=r(20745),i=n(r(38957)),s=document.getElementById("root");if(s){(0,o.createRoot)(s).render(a.default.createElement(i.default,null))}},871:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertFormula=t.FORMULA_ERRORS_LIST=t.FORMULA_CHANGES_LIST=void 0;const n=r(35232),a=r(61721),o={slice:"substring",start:"dateStart",end:"dateEnd"},i={add:"+",subtract:"-",multiply:"*",divide:"/",pow:"^",mod:"%",equal:"==",unequal:"!=",larger:">",largerEq:">=",smaller:"<",smallerEq:"<=",concat:"+"};function s(e,t,r,n){if(!e)return{formula:"",changes:t,errors:r,propsReferenced:n};const u=e.type;switch(u){case"literal":return{formula:e.value,changes:t,errors:[],propsReferenced:n};case"function":return function(e,t,r,n){const{args:a,name:u}=e,c=t.length,d=a.map((e=>s(e,t,r,n).formula),n),p=d.join(", ");let f;if(u in o){const e=o[u];t.splice(c,0,{changeIdentifier:u}),f=`${e}(${p})`}else if(u in i){const n=i[u];t.splice(c,0,{changeIdentifier:u}),2!==a.length&&r.push({errorIdentifier:"operatorIncorrectArgs",context:u}),f=`${l(e.args[0],d[0])} ${n} ${l(e.args[1],d[1])}`}else"unaryMinus"===u?(t.splice(c,0,{changeIdentifier:u}),f=`-${l(e.args[0],d[0])}`):"unaryPlus"===u?(t.splice(c,0,{changeIdentifier:u}),f=`toNumber(${d[0]})`):"day"===u?(t.splice(c,0,{changeIdentifier:u}),f=`day(${d[0]}) % 7`):"month"===u?(t.splice(c,0,{changeIdentifier:u}),f=`month(${d[0]}) - 1`):"join"===u?(t.splice(c,0,{changeIdentifier:u}),f=`join([${d.slice(1).join(", ")}], ${d[0]})`):f=`${u}(${p})`;return{formula:f,changes:t,errors:r,propsReferenced:n}}(e,t,r,n);case"property":return function(e,t,r,n){const o=e.propertyType;n.add(e.name);const i=`prop("${e.name}")`;switch(o){case"person":case"relation":return t.push({changeIdentifier:o,context:i}),{formula:`join(prop("${e.name}"), map(format(current)), ", ")`,changes:t,errors:r,propsReferenced:n};case"rollup":return t.push({changeIdentifier:o,context:i}),{formula:`join(prop("${e.name}"), map(format(current)), ",")`,changes:t,errors:r,propsReferenced:n};case"file":case"multi-select":return t.push({changeIdentifier:o,context:i}),{formula:`join(prop("${e.name}"), ", ")`,changes:t,errors:r,propsReferenced:n};case"id":return t.push({changeIdentifier:o,context:i}),{formula:`prop("${e.name}").split('-').last().toNumber()`,changes:t,errors:r,propsReferenced:n};case"other":return{formula:`prop("${e.name}")`,changes:t,errors:r,propsReferenced:n};default:(0,a.unreachable)(o)}}(e,t,r,n);case"parentheses":return{formula:`(${s(e.inner,t,r,n).formula})`,changes:t,errors:r,propsReferenced:n};case"operator":return function(e,t,r,n){const{args:a,operator:o}=e;if(a.length>1){return{formula:a.map((e=>s(e,t,r,n).formula)).join(` ${o} `),changes:t,errors:r,propsReferenced:n}}if(1===a.length){const e=s(a[0],t,r,n).formula;let i;return"not"===o?(t.push({changeIdentifier:"not"}),i=`!${l(a[0],e[0])})`):"+"===o?(t.push({changeIdentifier:"unaryPlus"}),i=`toNumber(${e})`):i=`${o}${e}`,{formula:i,changes:t,errors:r,propsReferenced:n}}return{formula:"",changes:t,errors:[...r,{errorIdentifier:"operatorNoArgs",context:e.operator}],propsReferenced:n}}(e,t,r,n);case"conditional":return function(e,t,r,n){const{condition:a,ifTrue:o,ifFalse:i}=e,u=[a,o,i].map((e=>s(e,t,r,n).formula));return{formula:`if(${l(e.condition,u[0])}, ${l(e.ifTrue,u[1])}, ${l(e.condition,u[2])})`,changes:t,errors:r,propsReferenced:n}}(e,t,r,n);case"symbol":return function(e,t,r,n){const{name:a}=e;if("pi"===a||"e"===a)return t.push({changeIdentifier:a}),{formula:`${a}()`,changes:t,errors:r,propsReferenced:n};return{formula:a,changes:t,errors:r,propsReferenced:n}}(e,t,r,n);case"error":return{formula:"",changes:t,errors:[...r,{errorIdentifier:"parserError",context:e.message}],propsReferenced:n};default:(0,a.unreachable)(u)}}function l(e,t){return"conditional"===e.type||"function"===e.type&&(Object.keys(i).includes(e.name)||["unaryPlus","unaryMinus"].includes(e.name))||"operator"===e.type&&void 0!==e.args&&e.args.length>=2?"("+t+")":t}t.FORMULA_CHANGES_LIST={slice:{description:"slice() is now substring(). Note that slice() still exists, but it is now a list function.",example:()=>'slice("abc", 1, 2) → substring("abc", 1, 2)'},start:{description:"start() is now dateStart().",example:()=>'start(prop("Date")) → dateStart(prop("Date"))'},end:{description:"end() is now dateEnd().",example:()=>'end(prop("Date")) → dateEnd(prop("Date"))'},unaryMinus:{description:"unaryMinus() is removed.",example:()=>"unaryMinus(1) → -1"},unaryPlus:{description:"unaryPlus() is removed. Use 'toNumber' instaed.",example:()=>'unaryPlus("1") → toNumber("1")'},larger:{description:"larger() is removed. Use '>' instead.",example:()=>"larger(1, 2) → 1 > 2"},largerEq:{description:"largerEq() is removed. Use '>=' instead.",example:()=>"largerEq(1, 2) → 1 >= 2"},smaller:{description:"smaller() is removed. Use '<' instead.",example:()=>"smaller(1, 2) → 1 < 2"},smallerEq:{description:"smallerEq() is removed. Use '<=' instead.",example:()=>"smallerEq(1, 2) → 1 <= 2"},not:{description:"not() is removed. Use '!' instead.",example:()=>"not(true) → !true"},add:{description:"add() no longer supports text values. We convert them all usages of add to use '+' instead for safety.",example:()=>"add(1, 2) → 1 + 2"},month:{description:"month() is now 1-indexed instead of 0-indexed. We convert all existing usages of month to subtract 1.",example:()=>"month(x) → month(x) - 1"},day:{description:"day() is now 1-indexed instead of 0-indexed. We convert all usages of day to be mod 7.",example:()=>"day(x) → day(x) % 7"},join:{description:"join() is now a list function and doesn't work for regular string params. We convert all usages of join to use the new list format function.",example:()=>'join(",","a","b","c") → join(["a","b","c"], ",")'},subtract:{description:"subtract() is converted to `-`. This isn't quite necessary as the function is available in 2.0.",example:()=>"subtract(1, 2) → 1 - 2"},multiply:{description:"multiply() is converted to `*`. This isn't quite necessary as the function is available in 2.0.",example:()=>"multiply(1, 2) → 1 * 2"},divide:{description:"divide() is converted to `/`. This isn't quite necessary as the function is available in 2.0.",example:()=>"divide(1, 2) → 1 / 2"},pow:{description:"pow() is converted to `^`. This isn't quite necessary as the function is available in 2.0.",example:()=>"pow(1, 2) → 1 ^ 2"},mod:{description:"mod() is converted to `%`. This isn't quite necessary as the function is available in 2.0.",example:()=>"mod(1, 2) → 1 % 2"},equal:{description:"equal() is converted to `==`. This isn't quite necessary as the function is available in 2.0.",example:()=>"equal(1, 2) → 1 == 2"},unequal:{description:"unequal() is converted to `!=`. This isn't quite necessary as the function is available in 2.0.",example:()=>"unequal(1, 2) → 1 != 2"},concat:{description:"concat() is now only used for lists, so existing usages were converted to `+`.",example:()=>'concat("a", "b") → "a" + "b"'},"+":{description:"+ as a unary operator is now removed. Use toNumber instead.",example:()=>'+"1" → toNumber("1")'},person:{description:"In 1.0, Person properties returned comma-separated text values. In 2.0, they are a list of Person objects. In the conversion, we re-map old prop references to the comma-separated text value to preserve outputs.",example:e=>`${e} → join(${e}, map(format(current)), ", ")`},relation:{description:"In 1.0, Relation properties returned comma-separated text values. In 2.0, they are a list of Page objects. In the conversion, we re-map old prop references to the comma-separated text value to preserve outputs.",example:e=>`${e} → join("${e}", map(format(current)), ", ")`},file:{description:"In 1.0, File properties returned comma-separated text values. In 2.0, they are a list of text. In the conversion, we re-map old prop references to the comma-separated text value to preserve outputs.",example:e=>`${e} → join(${e}, ", ")`},"multi-select":{description:"In 1.0, Multi-select properties returned comma-separated text values. In 2.0, they are a list of text. In the conversion, we re-map old prop references to the comma-separated text value to preserve outputs.",example:e=>`${e} → join(${e}, ", ")`},rollup:{description:'In 1.0, Rollup properties that are "show values" or "show values" returned comma-separated text values (without a space). In 2.0, they are a list of objects. In the conversion, we re-map old prop references to the comma-separated text value to preserve outputs.',example:e=>`${e} → ${e}, map(format(current)), ",")`},id:{description:'In 1.0, ID properties returned the ID number. In 2.0, they return a string with the prefix, e.g. "TASK-123". In the conversion, we re-map prop references to the ID number to preserve outputs.',example:e=>`${e} → ${e}.split('-').last().toNumber()`},pi:{description:"pi is now referred to with parentheses, like pi().",example:()=>"pi → pi()"},e:{description:"e is now referred to with parentheses, like e().",example:()=>"e → e()"}},t.FORMULA_ERRORS_LIST={operatorNoArgs:{text:e=>`Operator ${e} with no arguments`},operatorIncorrectArgs:{text:e=>`Operator ${e} called with incorrect arguments`},parserError:{text:e=>`Parser error: ${e}`}},t.convertFormula=function(e,t){return e?s((0,n.parseFormula)(e,t).formula,[],[],new Set):{formula:"",changes:[],errors:[],propsReferenced:new Set}}},35232:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,a)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.parseFormula=void 0;const i=o(r(55341)),s=r(61721);function l(e,t,r){var n;if(e){if("AccessorNode"===e.type||"ArrayNode"===e.type||"AssignmentNode"===e.type||"BlockNode"===e.type||"FunctionAssignmentNode"===e.type||"IndexNode"===e.type||"ObjectNode"===e.type||"RangeNode"===e.type){const t={type:"error",message:"Invalid syntax: "+e.toString()};return r.push(t.message),t}if("ConditionalNode"===e.type){const n=l(e.condition,t,r),a=l(e.trueExpr,t,r),o=l(e.falseExpr,t,r);if(!n)return;if("error"===n.type)return n;if(a&&"error"===a.type)return a;if(o&&"error"===o.type)return o;if(!a||!o){const t={type:"error",message:"Invalid conditional: "+e.toString()};return r.push(t.message),t}return{type:"conditional",condition:n,ifTrue:a,ifFalse:o}}if("ConstantNode"===e.type)return{type:"literal",value:"string"==typeof e.value?`"${e.value.replace(/\n/g,"\\n").replace(/"/g,'\\"').replace(/\t/g,"\\t")}"`:e.value};if("FunctionNode"===e.type){const{fn:a,args:o}=e;if("prop"===a.name){if(1!==o.length)return{type:"error",message:"Too many arguments passed to prop()."};const e=o[0];if("ConstantNode"!==e.type){const t={type:"error",message:"Invalid property reference: "+e.toString()};return r.push(t.message),t}return{type:"property",name:e.value,propertyType:null!==(n=t[e.value])&&void 0!==n?n:"other"}}const i=(0,s.compact)((o||[]).map((e=>l(e,t,r))));return{type:"function",name:a.name,args:i}}if("OperatorNode"===e.type){const{op:n,args:a}=e;return{type:"operator",operator:n,args:(0,s.compact)((a||[]).map((e=>l(e,t,r))))}}if("ParenthesisNode"===e.type)return l(e.content,t,r);if("SymbolNode"===e.type){const{name:t}=e;if(["e","pi","true","false"].includes(t))return{type:"symbol",name:t};{const e={type:"error",message:"Undefined constant:"+t};return r.push(e.message),e}}}}t.parseFormula=function(e,t){try{const r=l(i.parse(e),t,[]);return r?{formula:r,errors:[]}:{formula:void 0,errors:["Could not parse formula 😭"]}}catch(e){return{formula:void 0,errors:["Could not parse formula 😭"]}}}},94055:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PROPERTY_TYPES_STRING=t.PROPERTY_TYPES=void 0,t.PROPERTY_TYPES=["person","relation","rollup","id","file","multi-select","other"],t.PROPERTY_TYPES_STRING=t.PROPERTY_TYPES.filter((e=>"other"!==e)).join(", ")},61721:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unreachable=t.compact=void 0,t.compact=function(e){return e.filter(Boolean)},t.unreachable=function(e){throw new Error(`Expected value to never occur: ${JSON.stringify(e)}`)}},75042:function(){}},r={};function n(e){var a=r[e];if(void 0!==a)return a.exports;var o=r[e]={id:e,loaded:!1,exports:{}};return t[e].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}n.m=t,n.amdD=function(){throw new Error("define cannot be used indirect")},n.amdO={},e=[],n.O=function(t,r,a,o){if(!r){var i=1/0;for(c=0;c<e.length;c++){r=e[c][0],a=e[c][1],o=e[c][2];for(var s=!0,l=0;l<r.length;l++)(!1&o||i>=o)&&Object.keys(n.O).every((function(e){return n.O[e](r[l])}))?r.splice(l--,1):(s=!1,o<i&&(i=o));if(s){e.splice(c--,1);var u=a();void 0!==u&&(t=u)}}return t}o=o||0;for(var c=e.length;c>0&&e[c-1][2]>o;c--)e[c]=e[c-1];e[c]=[r,a,o]},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},function(){var e={179:0};n.O.j=function(t){return 0===e[t]};var t=function(t,r){var a,o,i=r[0],s=r[1],l=r[2],u=0;if(i.some((function(t){return 0!==e[t]}))){for(a in s)n.o(s,a)&&(n.m[a]=s[a]);if(l)var c=l(n)}for(t&&t(r);u<i.length;u++)o=i[u],n.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return n.O(c)},r=self.webpackChunknotion_formula_2_0_converter=self.webpackChunknotion_formula_2_0_converter||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var a=n.O(void 0,[594],(function(){return n(92629)}));a=n.O(a)}();